import{v as L,o as W,c as m,a as t,t as o,u as e,p as d,g as C,h as f,y as z,b as c,s as F,w as q,f as r,i as G,z as y,k as H,j as _,m as $,x as J}from"./app-CCP2hVtR.js";import{s as E}from"./index-B5S8LY6B.js";import{s as K}from"./index-UD0nC4Og.js";import"./index-CdoIoPxA.js";const O={class:"max-w-2xl mx-auto px-4 py-8 sm:py-12"},Q={class:"flex items-center gap-4 mb-10"},R={class:"w-16 h-16 rounded-full bg-emerald-100 dark:bg-emerald-900/50 flex items-center justify-center text-2xl font-bold text-emerald-600 dark:text-emerald-400 shrink-0"},X={class:"min-w-0"},Y={class:"text-2xl font-bold text-slate-800 dark:text-slate-200 truncate"},Z={key:0,class:"text-sm text-slate-500 dark:text-slate-400 truncate"},ee={class:"space-y-6"},se={class:"rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800 overflow-hidden"},te={class:"text-sm font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400 px-6 pt-5 pb-3"},ae={class:"px-6 py-4 border-t border-slate-200 dark:border-slate-800"},le={class:"flex items-center justify-between gap-4"},oe={class:"min-w-0"},ne={class:"text-xs font-medium text-slate-500 dark:text-slate-400"},re={key:0,class:"text-slate-800 dark:text-slate-200 truncate"},ie={key:1,class:"text-red-500 mt-1 block"},de={key:2,class:"text-emerald-600 dark:text-emerald-400 mt-1 block"},me={class:"px-6 py-4 border-t border-slate-200 dark:border-slate-800"},ce={class:"flex items-center justify-between gap-4"},ue={class:"min-w-0"},pe={class:"text-xs font-medium text-slate-500 dark:text-slate-400"},fe={key:0,class:"text-slate-800 dark:text-slate-200 truncate"},xe={key:1,class:"text-red-500 mt-1 block"},ke={key:2,class:"text-emerald-600 dark:text-emerald-400 mt-1 block"},be={class:"px-6 py-4 border-t border-slate-200 dark:border-slate-800"},ve={class:"flex items-center justify-between gap-4"},_e={class:"min-w-0"},ye={class:"text-xs font-medium text-slate-500 dark:text-slate-400"},we={key:0,class:"text-slate-800 dark:text-slate-200 truncate"},ge={key:1,class:"text-red-500 mt-1 block"},he={key:2,class:"text-emerald-600 dark:text-emerald-400 mt-1 block"},Ve={class:"rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800 overflow-hidden"},Ce={class:"px-6 pt-5 pb-3 flex items-center justify-between"},ze={class:"text-sm font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400"},$e={key:0,class:"px-6 pb-5"},Se={class:"flex flex-col gap-1.5"},Ue={class:"text-xs font-medium text-slate-500 dark:text-slate-400"},je={class:"flex flex-col gap-1.5"},Ae={class:"text-xs font-medium text-slate-500 dark:text-slate-400"},Pe={class:"flex flex-col gap-1.5"},Fe={class:"text-xs font-medium text-slate-500 dark:text-slate-400"},Ee={class:"flex gap-2"},Ne={key:0,class:"text-red-500 block"},Me={key:1,class:"text-emerald-600 dark:text-emerald-400 block"},Be={class:"rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800 px-6 py-5"},De={class:"flex items-center justify-between"},Te={class:"text-sm font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400"},Ie={class:"text-sm text-slate-500 dark:text-slate-400 mt-1"},Le={class:"rounded-2xl border-2 border-red-200 dark:border-red-900 px-6 py-5"},We={class:"text-sm font-semibold uppercase tracking-wider text-red-500 dark:text-red-400 mb-2"},qe={class:"text-sm text-slate-500 dark:text-slate-400 mb-4"},Ge={class:"text-sm text-slate-600 dark:text-slate-400 mb-4"},He={key:0,class:"text-sm text-red-500 mb-4"},Je={class:"flex justify-end gap-2"},Ye={__name:"ProfileSettings",setup(Ke){const i=L(),{t:a}=H(),w=$(!1),S=$(!1),U=$(!1),u=y({name:!1,nickname:!1,email:!1,password:!1}),x=y({name:"",nickname:"",email:""}),k=y({name:!1,nickname:!1,email:!1,password:!1}),p=y({name:"",nickname:"",email:"",password:""}),v=y({name:!1,nickname:!1,email:!1,password:!1}),b=y({current_password:"",password:"",password_confirmation:""});let j={};function A(l,s){x[l]=s,p[l]="",v[l]=!1,u[l]=!0}function g(l){v[l]=!0,u[l]=!1,j[l]&&clearTimeout(j[l]),j[l]=setTimeout(()=>{v[l]=!1},2e3)}function h(l,s){return l.response?.data?.errors?.[s]?.[0]||l.response?.data?.message||a("common.error")}async function N(){k.name=!0,p.name="";try{const{data:l}=await _.profile.update({name:x.name});i.user={...i.user,name:l.user.name},g("name")}catch(l){p.name=h(l,"name")}finally{k.name=!1}}async function M(){k.nickname=!0,p.nickname="";try{const{data:l}=await _.profile.updateNickname(x.nickname);i.player={...i.player,nickname:l.player.nickname},g("nickname")}catch(l){p.nickname=h(l,"nickname")}finally{k.nickname=!1}}async function B(){k.email=!0,p.email="";try{const{data:l}=await _.profile.update({email:x.email});i.user={...i.user,email:l.user.email},g("email")}catch(l){p.email=h(l,"email")}finally{k.email=!1}}async function D(){k.password=!0,p.password="";try{await _.profile.updatePassword({current_password:b.current_password,password:b.password,password_confirmation:b.password_confirmation}),P(),g("password")}catch(l){p.password=h(l,"password")}finally{k.password=!1}}function P(){u.password=!1,b.current_password="",b.password="",b.password_confirmation="",p.password=""}async function T(l){try{l?await _.auth.twoFactor.enable():await _.auth.twoFactor.disable("")}catch{U.value=!l}}const V=$("");async function I(){S.value=!0,V.value="";try{await _.profile.deleteAccount(),i.clearAuth(),w.value=!1,J.visit("/")}catch(l){V.value=l.response?.data?.message||a("common.error"),S.value=!1}}return W(()=>{x.name=i.user?.name||"",x.nickname=i.nickname||"",x.email=i.user?.email||""}),(l,s)=>(r(),m("div",O,[t("div",Q,[t("div",R,o(e(i).nickname?.charAt(0)?.toUpperCase()),1),t("div",X,[t("h1",Y,o(e(i).nickname),1),e(i).user?.email?(r(),m("p",Z,o(e(i).user.email),1)):d("",!0)])]),t("div",ee,[t("section",se,[t("h2",te,o(e(a)("profile.settings.account")),1),t("div",ae,[t("div",le,[t("div",oe,[t("label",ne,o(e(a)("profile.settings.name")),1),u.name?d("",!0):(r(),m("p",re,o(e(i).user?.name||"—"),1))]),u.name?d("",!0):(r(),C(e(f),{key:0,label:e(a)("game.edit"),severity:"secondary",variant:"text",size:"small",onClick:s[0]||(s[0]=n=>A("name",e(i).user?.name||""))},null,8,["label"]))]),u.name?(r(),m("form",{key:0,onSubmit:z(N,["prevent"]),class:"mt-2 flex gap-2"},[c(e(F),{modelValue:x.name,"onUpdate:modelValue":s[1]||(s[1]=n=>x.name=n),class:"flex-1",autofocus:""},null,8,["modelValue"]),c(e(f),{type:"submit",label:e(a)("common.save"),severity:"success",size:"small",loading:k.name},null,8,["label","loading"]),c(e(f),{label:e(a)("common.cancel"),severity:"secondary",variant:"text",size:"small",onClick:s[2]||(s[2]=n=>u.name=!1)},null,8,["label"])],32)):d("",!0),p.name?(r(),m("small",ie,o(p.name),1)):d("",!0),v.name?(r(),m("small",de,o(e(a)("profile.settings.saved")),1)):d("",!0)]),t("div",me,[t("div",ce,[t("div",ue,[t("label",pe,o(e(a)("profile.settings.nickname")),1),u.nickname?d("",!0):(r(),m("p",fe,o(e(i).nickname),1))]),u.nickname?d("",!0):(r(),C(e(f),{key:0,label:e(a)("game.edit"),severity:"secondary",variant:"text",size:"small",onClick:s[3]||(s[3]=n=>A("nickname",e(i).nickname||""))},null,8,["label"]))]),u.nickname?(r(),m("form",{key:0,onSubmit:z(M,["prevent"]),class:"mt-2 flex gap-2"},[c(e(F),{modelValue:x.nickname,"onUpdate:modelValue":s[4]||(s[4]=n=>x.nickname=n),class:"flex-1",autofocus:""},null,8,["modelValue"]),c(e(f),{type:"submit",label:e(a)("common.save"),severity:"success",size:"small",loading:k.nickname},null,8,["label","loading"]),c(e(f),{label:e(a)("common.cancel"),severity:"secondary",variant:"text",size:"small",onClick:s[5]||(s[5]=n=>u.nickname=!1)},null,8,["label"])],32)):d("",!0),p.nickname?(r(),m("small",xe,o(p.nickname),1)):d("",!0),v.nickname?(r(),m("small",ke,o(e(a)("profile.settings.saved")),1)):d("",!0)]),t("div",be,[t("div",ve,[t("div",_e,[t("label",ye,o(e(a)("profile.settings.email")),1),u.email?d("",!0):(r(),m("p",we,o(e(i).user?.email||"—"),1))]),u.email?d("",!0):(r(),C(e(f),{key:0,label:e(a)("game.edit"),severity:"secondary",variant:"text",size:"small",onClick:s[6]||(s[6]=n=>A("email",e(i).user?.email||""))},null,8,["label"]))]),u.email?(r(),m("form",{key:0,onSubmit:z(B,["prevent"]),class:"mt-2 flex gap-2"},[c(e(F),{modelValue:x.email,"onUpdate:modelValue":s[7]||(s[7]=n=>x.email=n),type:"email",class:"flex-1",autofocus:""},null,8,["modelValue"]),c(e(f),{type:"submit",label:e(a)("common.save"),severity:"success",size:"small",loading:k.email},null,8,["label","loading"]),c(e(f),{label:e(a)("common.cancel"),severity:"secondary",variant:"text",size:"small",onClick:s[8]||(s[8]=n=>u.email=!1)},null,8,["label"])],32)):d("",!0),p.email?(r(),m("small",ge,o(p.email),1)):d("",!0),v.email?(r(),m("small",he,o(e(a)("profile.settings.saved")),1)):d("",!0)])]),t("section",Ve,[t("div",Ce,[t("h2",ze,o(e(a)("profile.settings.changePassword")),1),u.password?d("",!0):(r(),C(e(f),{key:0,label:e(a)("game.edit"),severity:"secondary",variant:"text",size:"small",onClick:s[9]||(s[9]=n=>{P(),u.password=!0})},null,8,["label"]))]),u.password?(r(),m("form",{key:1,onSubmit:z(D,["prevent"]),class:"px-6 pb-5 space-y-4"},[t("div",Se,[t("label",Ue,o(e(a)("profile.settings.currentPassword")),1),c(e(E),{modelValue:b.current_password,"onUpdate:modelValue":s[10]||(s[10]=n=>b.current_password=n),feedback:!1,toggleMask:"",inputClass:"w-full",class:"w-full"},null,8,["modelValue"])]),t("div",je,[t("label",Ae,o(e(a)("profile.settings.newPassword")),1),c(e(E),{modelValue:b.password,"onUpdate:modelValue":s[11]||(s[11]=n=>b.password=n),toggleMask:"",inputClass:"w-full",class:"w-full"},null,8,["modelValue"])]),t("div",Pe,[t("label",Fe,o(e(a)("profile.settings.confirmPassword")),1),c(e(E),{modelValue:b.password_confirmation,"onUpdate:modelValue":s[12]||(s[12]=n=>b.password_confirmation=n),feedback:!1,toggleMask:"",inputClass:"w-full",class:"w-full"},null,8,["modelValue"])]),t("div",Ee,[c(e(f),{type:"submit",label:e(a)("common.save"),severity:"success",size:"small",loading:k.password},null,8,["label","loading"]),c(e(f),{label:e(a)("common.cancel"),severity:"secondary",variant:"text",size:"small",onClick:P},null,8,["label"])]),p.password?(r(),m("small",Ne,o(p.password),1)):d("",!0),v.password?(r(),m("small",Me,o(e(a)("profile.settings.saved")),1)):d("",!0)],32)):(r(),m("div",$e,[...s[17]||(s[17]=[t("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"••••••••",-1)])]))]),t("section",Be,[t("div",De,[t("div",null,[t("h2",Te,o(e(a)("profile.settings.twoFactor")),1),t("p",Ie,o(e(a)("auth.login.twoFactorCode")),1)]),c(e(K),{modelValue:U.value,"onUpdate:modelValue":[s[13]||(s[13]=n=>U.value=n),T]},null,8,["modelValue"])])]),t("section",Le,[t("h2",We,o(e(a)("profile.settings.deleteAccount")),1),t("p",qe,o(e(a)("profile.settings.deleteWarning")),1),c(e(f),{label:e(a)("profile.settings.deleteAccount"),severity:"danger",variant:"outlined",size:"small",onClick:s[14]||(s[14]=n=>w.value=!0)},null,8,["label"]),c(e(G),{visible:w.value,"onUpdate:visible":s[16]||(s[16]=n=>w.value=n),header:e(a)("profile.settings.deleteAccount"),modal:"",style:{width:"25rem"}},{default:q(()=>[t("p",Ge,o(e(a)("common.confirm"))+"? ",1),V.value?(r(),m("p",He,o(V.value),1)):d("",!0),t("div",Je,[c(e(f),{label:e(a)("common.cancel"),severity:"secondary",variant:"text",onClick:s[15]||(s[15]=n=>w.value=!1)},null,8,["label"]),c(e(f),{label:e(a)("common.confirm"),severity:"danger",loading:S.value,onClick:I},null,8,["label","loading"])])]),_:1},8,["visible","header"])])])]))}};export{Ye as default};
